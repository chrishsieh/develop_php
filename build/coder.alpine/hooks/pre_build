#!/bin/bash
if [[ "$(docker images -q ${DOCKER_REPO}:coder-alpine${CODER_VERSION} 2> /dev/null)" == "" ]]; then
echo "=> No need build alpine version"
else
echo "=> Building the coder alpine version"
docker build --build-arg CODER_VERSION=$CODER_VERSION -t $DOCKER_REPO:coder-alpine -t $DOCKER_REPO:coder-alpine$CODER_VERSION - < ${PWD}/coder-gen/Dockerfile.alpine
docker push $DOCKER_REPO:coder-alpine
docker push $DOCKER_REPO:coder-alpine$CODER_VERSION
fi
