#!/bin/bash
docker images -q ${DOCKER_REPO}:coder-stretch-slim${CODER_VERSION}
if [[ "$(docker images -q ${DOCKER_REPO}:coder-stretch-slim${CODER_VERSION} 2> /dev/null)" == "" ]]; then
echo "=> Building the coder-stretch-slim"
docker build --build-arg CODER_VERSION=$CODER_VERSION -t $DOCKER_REPO:coder-stretch-slim -t $DOCKER_REPO:coder-stretch-slim$CODER_VERSION - < ${PWD}/coder-gen/Dockerfile
docker push $DOCKER_REPO:coder-stretch-slim
docker push $DOCKER_REPO:coder-stretch-slim$CODER_VERSION
else
echo "=> No need build"
fi
